<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Thống kê số đơn hoàn thành</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
    <link href="https://fonts.googleapis.com/css?family=Inter:400,600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
    :root {
        --main-bg: #fffdfc;
        --main-card: #fffdfccf;
        --main-text: #25312b;
        --main-th: #ffe082;
        --main-th-bright: #fff9d1;
        --main-border: #d8d8cc;
        --color-green: #4e8573;
        --color-pass: #38b430;
        --color-fail: #df2323;
        --shadow-light: rgba(0,0,0,0.10);
    }
    body {
        min-height: 100vh;
        background: var(--main-bg);
        color: var(--main-text);
        font-family: 'Open Sans', Arial, sans-serif;
        margin:0;padding:0;
        display: flex; align-items: center; justify-content: center;
        transition: background 0.22s, color 0.18s;
    }
    .info-box {
        background: var(--main-card);
        color: var(--main-text);
        border-radius: 20px;
        max-width: 900px;
        margin: 28px auto 32px auto;
        padding: 32px 28px 33px 28px;
        box-shadow: 0 8px 40px var(--shadow-light), 0 1.5px 13px #c49c4850;
        transition: background 0.22s, color 0.17s;
        width: 100%;
    }
    .log-title {
        color: var(--color-green);
        text-shadow: 0 2px 11px #4e857348;
        font-size: 26px;
        text-align: center;
        margin-bottom: 14px;
        font-weight: bold;
        letter-spacing: 0.04em;
    }
    .table-responsive {
        width:100%;
        overflow-x:auto;
        margin-bottom: 24px;
    }
    table {
        width: 100%;
        background: var(--main-card);
        border-radius: 14px;
        border-collapse: collapse;
        box-shadow: 0 2.5px 11px #25312b10;
    }
    th, td {
        border: 1.2px solid var(--main-border);
        padding: 9px 8px;
        font-size: 15.2px;
        text-align: center;
        color: var(--main-text);
        background: transparent;
        transition: background 0.17s, color 0.17s;
    }
    th {
        background: var(--main-th);
        color: #25312b;
        font-weight: 700;
        font-size: 16px;
    }
    tr:nth-child(even) { background: #faf6ea;}
    tr:nth-child(odd) { background: #fffdfc;}
    .bold { font-weight: bold; }
    .total-cell {
        font-weight:900; color:var(--color-green);
    }
    .btn-action-back {
        background: var(--color-green);
        color: var(--main-th-bright);
        border: none;
        border-radius: 11px;
        font-size:17px;
        font-weight:600;
        padding: 9px 33px;
        margin: 24px auto 0 auto;
        display: block;
        text-decoration: none;
        box-shadow: 0 2.5px 13px #25312b23;
        transition: background 0.18s, color 0.18s;
        letter-spacing: 0.01em;
    }
    .btn-action-back:hover {
        background: var(--main-th);
        color: #25312b;
    }
    .ca-hc { color: var(--color-pass); font-weight: bold; }
    .ca-ot { color: var(--color-fail); font-weight: bold; }
    @media (max-width: 800px) {
        .info-box {
            padding: 5vw 2vw 6vw 2vw;
            max-width: 100vw;
            border-radius: 11px;
        }
        .log-title {
            font-size: 17.5px;
            margin-bottom: 8px;
        }
        th, td {
            font-size: 12.8px;
            padding: 6px 3px;
        }
    }
    /* Dark mode biến màu */
    body.dark, .info-box.dark {
        --main-bg: #2b3938;
        --main-card: #374B4A;
        --main-text: #f6f6ef;
        --main-th: #ffe082;
        --main-th-bright: #fffbe6;
        --main-border: #263d3a;
        --color-green: #91b8a2;
        --color-pass: #93e5a0;
        --color-fail: #e68282;
        --shadow-light: rgba(255,255,255,0.07);
    }
    body.dark .info-box, .info-box.dark {
        background: #334c47 !important;
        color: #f6f6ef !important;
    }
    body.dark .log-title, .info-box.dark .log-title {
        color: var(--main-th);
    }
    body.dark table, .info-box.dark table { background: #374B4A !important; }
    body.dark th, .info-box.dark th {
        background: var(--main-th) !important;
        color: #25312b !important;
    }
    body.dark tr:nth-child(even), body.dark tr:nth-child(odd), .info-box.dark tr:nth-child(even), .info-box.dark tr:nth-child(odd) {
        background: #334c47 !important;
    }
    body.dark td, .info-box.dark td {
        color: #f6f6ef !important;
        background: #334c47;
    }
    body.dark .btn-action-back, .info-box.dark .btn-action-back {
        background: var(--main-th);
        color: #25312b;
    }
    body.dark .btn-action-back:hover, .info-box.dark .btn-action-back:hover {
        background: #bfa87b;
        color: #374B4A;
    }
    body.dark .ca-hc { color: #72e2b5 !important; font-weight: bold; }
    body.dark .ca-ot { color: #ff6b81 !important; font-weight: bold; }
    /* Theme button darkmode nếu có */
    #theme-btn {
        position:fixed; right:22px; bottom:21px; z-index:11001;
        background: var(--main-th);
        color: #344833;
        border-radius: 100px;
        font-size: 19px;
        padding: 7px 13px;
        border:none;
        box-shadow: 0 2px 10px #4d665c35;
        cursor:pointer;
        height: 42px; width: 42px; min-width:38px;
        display:flex;align-items:center;justify-content:center;opacity:0.96;
        transition: background 0.16s, color 0.16s;
    }
    #theme-btn:hover { background: var(--color-green); color: #fff; }
    body.dark #theme-btn { background: #6c837f; color: #ffe082; }
    body.dark td[style*="color:var(--color-pass)"] { color: #93e5a0 !important; }
    body.dark td[style*="#bbb"] { color: #bbb !important; }
    body.dark .total-cell { color: #93e5a0 !important; }
    </style>
</head>
<body>
    <button id="theme-btn" title="Chuyển Dark/Light mode"><i class="fa fa-moon"></i></button>
    <div class="info-box{% if darkmode %} dark{% endif %}">
        <div class="log-title"><i class="fa fa-calendar"></i> Bảng thống kê số đơn hoàn thành từng ngày</div>
        <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    {% for h in header %}
                    <th>{{ h }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in rows %}
                <tr>
                    <td>{{ row.date }}</td>
                    <td class="{{ 'ca-hc' if row.ca=='HC' else 'ca-ot' }}">{{ row.ca }}</td>
                    {% for n in row.types %}
                    <td style="font-weight:700; color:{{ 'var(--color-pass)' if n else '#bbb' }};">{{ n if n else "" }}</td>
                    {% endfor %}
                    <td class="total-cell">{{ row.total if row.total else "" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <a href="/" class="btn-action-back"><i class="fa fa-chevron-left"></i> Quay về trang chính</a>
    </div>
    <script>
        // Darkmode toggle
        let dark = localStorage.getItem("vfr-darkmode") === "1";
        function applyDark(b) {
            document.body.classList.toggle("dark", b);
            localStorage.setItem("vfr-darkmode", b ? "1" : "0");
        }
        applyDark(dark);
        document.getElementById('theme-btn').onclick = () => {
            dark = !dark;
            applyDark(dark);
        };
    </script>
</body>
</html>
